{
  "type": "component",
  "npmDependencies": [
    "dayjs",
    "react-icons"
  ],
  "fileDependencies": [
    "./box",
    "./button",
    "./flex",
    "./input",
    "./popover"
  ],
  "id": "date-range-picker",
  "file": {
    "name": "date-range-picker.tsx",
    "content": "\"use client\";\n\nimport { createContext } from \"@dreamy-ui/react\";\nimport { useControllableState } from \"@dreamy-ui/react\";\nimport dayjs, { type Dayjs } from \"dayjs\";\nimport { forwardRef, useMemo, useState } from \"react\";\nimport { BiChevronLeft, BiChevronRight } from \"react-icons/bi\";\nimport { LuCalendar } from \"react-icons/lu\";\nimport { createStyleContext } from \"styled-system/jsx\";\nimport { type DateRangePickerVariantProps, dateRangePicker } from \"styled-system/recipes\";\nimport { Box, type BoxProps } from \"./box\";\nimport { Button, type ButtonProps } from \"./button\";\nimport { Flex, type FlexProps } from \"./flex\";\nimport { Input as InputComponent, InputGroup, type InputGroupProps, InputRightAddon } from \"./input\";\nimport * as Popover from \"./popover\";\n\nconst { withProvider, withContext } = createStyleContext(dateRangePicker);\n\nconst WEEKDAYS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\n\ninterface DateRange {\n    start: Date | null;\n    end: Date | null;\n}\n\ninterface DateRangePickerContextValue {\n    value: DateRange | null;\n    setValue: (range: DateRange | null) => void;\n    viewDate: Dayjs;\n    setViewDate: (date: Dayjs) => void;\n    selectingStart: boolean;\n    setSelectingStart: (selecting: boolean) => void;\n    minDate?: Date;\n    maxDate?: Date;\n    dateFormat: string;\n    placeholder: string;\n    showFooter: boolean;\n    presets?: Record<string, { label: string; value: DateRange }>;\n    onApply?: () => void;\n    onCancel?: () => void;\n}\n\nconst [DateRangePickerProvider, useDateRangePickerContext] =\n    createContext<DateRangePickerContextValue>({\n        strict: true,\n        name: \"DateRangePickerContext\"\n    });\n\nexport interface DateRangePickerRootProps extends Omit<BoxProps, \"defaultValue\" | \"onChange\" | \"value\">, DateRangePickerVariantProps {\n    /**\n     * The selected date range value\n     */\n    value?: DateRange | null;\n    /**\n     * The default selected date range value\n     */\n    defaultValue?: DateRange | null;\n    /**\n     * Callback fired when the date range changes\n     */\n    onChange?: (range: DateRange | null) => void;\n    /**\n     * The function to call when the apply button is clicked\n     */\n    onApply?: () => void;\n    /**\n     * The function to call when the cancel button is clicked\n     */\n    onCancel?: () => void;\n    /**\n     * Format string for displaying the date in the input\n     * @default \"MMM D, YYYY\"\n     */\n    dateFormat?: string;\n    /**\n     * Placeholder text for the input\n     * @default \"Select date range\"\n     */\n    placeholder?: string;\n    /**\n     * Minimum selectable date\n     */\n    minDate?: Date;\n    /**\n     * Maximum selectable date\n     */\n    maxDate?: Date;\n    /**\n     * Whether to show the footer with Cancel/Apply buttons\n     * @default false\n     */\n    showFooter?: boolean;\n    /**\n     * Date range presets to display\n     */\n    presets?: Record<string, { label: string; value: DateRange }>;\n}\n\nexport const Root = withProvider(\n    forwardRef<HTMLDivElement, DateRangePickerRootProps>(function DateRangePickerRoot(props, ref) {\n    const {\n        value: valueProp,\n        defaultValue,\n        onChange,\n        onApply,\n        onCancel,\n        dateFormat = \"MMM D, YYYY\",\n        placeholder = \"Select date range\",\n        minDate,\n        maxDate,\n        showFooter = false,\n        presets,\n        children,\n        ...rest\n    } = props;\n\n    const [value, setValue] = useControllableState<DateRange | null>({\n        value: valueProp,\n        defaultValue: defaultValue ?? null,\n        onChange\n    });\n\n    const [isOpen, setIsOpen] = useState(false);\n    const [viewDate, setViewDate] = useState(() => {\n        if (value?.start) return dayjs(value.start);\n        return dayjs();\n    });\n    const [selectingStart, setSelectingStart] = useState(true);\n\n    const handleApply = () => {\n        onApply?.();\n        setIsOpen(false);\n    };\n\n    const handleCancel = () => {\n        onCancel?.();\n        setIsOpen(false);\n    };\n\n    return (\n        <DateRangePickerProvider\n            value={{\n                value,\n                setValue: (range) => {\n                    setValue(range);\n                    if (!showFooter && range?.start && range?.end) {\n                        setIsOpen(false);\n                    }\n                },\n                viewDate,\n                setViewDate,\n                selectingStart,\n                setSelectingStart,\n                minDate,\n                maxDate,\n                dateFormat,\n                placeholder,\n                showFooter,\n                presets,\n                onApply: handleApply,\n                onCancel: handleCancel\n            }}\n        >\n            <Popover.Root\n                isOpen={isOpen}\n                onOpen={handleApply}\n                onClose={handleCancel}\n            >\n                <Box\n                    ref={ref}\n                    {...rest}\n                >\n                    {children}\n                </Box>\n            </Popover.Root>\n        </DateRangePickerProvider>\n    );\n    }),\n    \"root\"\n);\n\nexport interface DateRangePickerTriggerProps extends ButtonProps {}\n\nexport const Trigger = withContext(\n    forwardRef<HTMLButtonElement, DateRangePickerTriggerProps>(function DateRangePickerTrigger(props, ref) {\n        return (\n            <Popover.Trigger>\n                <Button\n                    ref={ref}\n                    variant=\"outline\"\n                    {...props}\n                />\n            </Popover.Trigger>\n        );\n    }),\n    \"trigger\"\n);\n\nexport interface DateRangePickerInputProps extends InputGroupProps {}\n\nexport const Input = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerInputProps>(function DateRangePickerInput(props, ref) {\n        const context = useDateRangePickerContext();\n        const formattedRange =\n            context.value?.start && context.value?.end\n                ? `${dayjs(context.value.start).format(context.dateFormat)} â€“ ${dayjs(context.value.end).format(context.dateFormat)}`\n                : context.placeholder;\n\n        return (\n            <Popover.Trigger>\n                <InputGroup ref={ref}>\n                    <InputComponent\n                        placeholder={context.placeholder}\n                        readOnly\n                        value={formattedRange}\n                        {...props}\n                    />\n                    <InputRightAddon>\n                        <LuCalendar />\n                    </InputRightAddon>\n                </InputGroup>\n            </Popover.Trigger>\n        );\n    }),\n    \"trigger\"\n);\n\nexport interface DateRangePickerPopoverProps extends Omit<Popover.PopoverContentProps, \"transition\"> {}\n\nexport const PopoverContent = withContext(\n    forwardRef<HTMLElement, DateRangePickerPopoverProps>(function DateRangePickerPopover(props, ref) {\n        const { transition, ...restProps } = props;\n        return (\n            <Popover.Content\n                ref={ref}\n                {...restProps}\n            />\n        );\n    }),\n    \"popover\"\n);\n\nexport interface DateRangePickerCalendarProps extends BoxProps {}\n\nexport const Calendar = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarProps>(function DateRangePickerCalendar(props, ref) {\n        const context = useDateRangePickerContext();\n        const {\n            value,\n            setValue,\n            viewDate,\n            setViewDate,\n            selectingStart,\n            setSelectingStart,\n            minDate,\n            maxDate\n        } = context;\n\n        const calendarDays = useMemo(() => {\n            const startOfMonth = viewDate.startOf(\"month\");\n            const endOfMonth = viewDate.endOf(\"month\");\n            const startOfCalendar = startOfMonth.startOf(\"week\");\n            const endOfCalendar = endOfMonth.endOf(\"week\");\n\n            const days: Dayjs[] = [];\n            let current = startOfCalendar;\n\n            while (current.isBefore(endOfCalendar) || current.isSame(endOfCalendar, \"day\")) {\n                days.push(current);\n                current = current.add(1, \"day\");\n            }\n\n            return days;\n        }, [viewDate]);\n\n        const handlePreviousMonth = () => {\n            setViewDate(viewDate.subtract(1, \"month\"));\n        };\n\n        const handleNextMonth = () => {\n            setViewDate(viewDate.add(1, \"month\"));\n        };\n\n        const handleDateClick = (date: Dayjs) => {\n            if (minDate && date.isBefore(dayjs(minDate), \"day\")) return;\n            if (maxDate && date.isAfter(dayjs(maxDate), \"day\")) return;\n\n            const currentRange = value || { start: null, end: null };\n\n            if (selectingStart || !currentRange.start) {\n                setValue({ start: date.toDate(), end: null });\n                setSelectingStart(false);\n            } else {\n                if (date.isBefore(dayjs(currentRange.start), \"day\")) {\n                    setValue({ start: date.toDate(), end: currentRange.start });\n                } else {\n                    setValue({ start: currentRange.start, end: date.toDate() });\n                }\n            }\n        };\n\n        const isToday = (date: Dayjs) => date.isSame(dayjs(), \"day\");\n        const isStart = (date: Dayjs) => value?.start && dayjs(value.start).isSame(date, \"day\");\n        const isEnd = (date: Dayjs) => value?.end && dayjs(value.end).isSame(date, \"day\");\n        const isInRange = (date: Dayjs) => {\n            if (!value?.start || !value?.end) return false;\n            const start = dayjs(value.start);\n            const end = dayjs(value.end);\n            return date.isAfter(start, \"day\") && date.isBefore(end, \"day\");\n        };\n        const isOutsideMonth = (date: Dayjs) => !date.isSame(viewDate, \"month\");\n        const isDisabled = (date: Dayjs) => {\n            if (minDate && date.isBefore(dayjs(minDate), \"day\")) return true;\n            if (maxDate && date.isAfter(dayjs(maxDate), \"day\")) return true;\n            return false;\n        };\n\n        return (\n            <Box\n                ref={ref}\n                {...props}\n            >\n                <CalendarHeader>\n                    <CalendarNav>\n                        <CalendarNavButton\n                            onClick={handlePreviousMonth}\n                            type=\"button\"\n                        >\n                            <BiChevronLeft />\n                        </CalendarNavButton>\n                        <CalendarTitle>{viewDate.format(\"MMMM YYYY\")}</CalendarTitle>\n                        <CalendarNavButton\n                            onClick={handleNextMonth}\n                            type=\"button\"\n                        >\n                            <BiChevronRight />\n                        </CalendarNavButton>\n                    </CalendarNav>\n                </CalendarHeader>\n                <CalendarGrid>\n                    <CalendarGridHeader>\n                        {WEEKDAYS.map((day) => (\n                            <CalendarGridHeaderCell key={day}>{day}</CalendarGridHeaderCell>\n                        ))}\n                    </CalendarGridHeader>\n                    <CalendarGridBody>\n                        {calendarDays.map((date) => (\n                            <CalendarCell key={date.format(\"YYYY-MM-DD\")}>\n                                <CalendarCellButton\n                                    data-in-range={isInRange(date) ? \"\" : undefined}\n                                    data-outside-month={isOutsideMonth(date) ? \"\" : undefined}\n                                    data-range-end={isEnd(date) ? \"\" : undefined}\n                                    data-range-start={isStart(date) ? \"\" : undefined}\n                                    data-selected={isStart(date) || isEnd(date) ? \"\" : undefined}\n                                    data-today={isToday(date) ? \"\" : undefined}\n                                    disabled={isDisabled(date)}\n                                    onClick={() => handleDateClick(date)}\n                                    type=\"button\"\n                                >\n                                    {date.format(\"D\")}\n                                </CalendarCellButton>\n                            </CalendarCell>\n                        ))}\n                    </CalendarGridBody>\n                </CalendarGrid>\n            </Box>\n        );\n    }),\n    \"calendar\"\n);\n\nexport interface DateRangePickerCalendarHeaderProps extends FlexProps {}\n\nexport const CalendarHeader = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarHeaderProps>(function DateRangePickerCalendarHeader(props, ref) {\n        return (\n            <Flex\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"calendarHeader\"\n);\n\nexport interface DateRangePickerCalendarTitleProps extends BoxProps {}\n\nexport const CalendarTitle = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarTitleProps>(function DateRangePickerCalendarTitle(props, ref) {\n        return (\n            <Box\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"calendarTitle\"\n);\n\nexport interface DateRangePickerCalendarNavProps extends FlexProps {}\n\nexport const CalendarNav = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarNavProps>(function DateRangePickerCalendarNav(props, ref) {\n        return (\n            <Flex\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"calendarNav\"\n);\n\nexport interface DateRangePickerCalendarNavButtonProps extends ButtonProps {}\n\nexport const CalendarNavButton = withContext(\n    forwardRef<HTMLButtonElement, DateRangePickerCalendarNavButtonProps>(function DateRangePickerCalendarNavButton(props, ref) {\n        return (\n            <Button\n                ref={ref}\n                size=\"sm\"\n                variant=\"ghost\"\n                {...props}\n            />\n        );\n    }),\n    \"calendarNavButton\"\n);\n\nexport interface DateRangePickerCalendarGridProps extends BoxProps {}\n\nexport const CalendarGrid = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridProps>(function DateRangePickerCalendarGrid(props, ref) {\n        return (\n            <Box\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"calendarGrid\"\n);\n\nexport interface DateRangePickerCalendarGridHeaderProps extends BoxProps {}\n\nexport const CalendarGridHeader = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridHeaderProps>(function DateRangePickerCalendarGridHeader(props, ref) {\n        return (\n            <Box\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"calendarGridHeader\"\n);\n\nexport interface DateRangePickerCalendarGridHeaderCellProps extends BoxProps {}\n\nexport const CalendarGridHeaderCell = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridHeaderCellProps>(function DateRangePickerCalendarGridHeaderCell(props, ref) {\n    return (\n        <Box\n            ref={ref}\n            {...props}\n            />\n        );\n    }),\n    \"calendarGridHeaderCell\"\n);\n\nexport interface DateRangePickerCalendarGridBodyProps extends BoxProps {}\n\nexport const CalendarGridBody = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridBodyProps>(function DateRangePickerCalendarGridBody(props, ref) {\n        return (\n            <Box\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"calendarGridBody\"\n);\n\nexport interface DateRangePickerCalendarCellProps extends BoxProps {}\n\nexport const CalendarCell = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerCalendarCellProps>(function DateRangePickerCalendarCell(props, ref) {\n        return (\n            <Box\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"calendarCell\"\n);\n\nexport interface DateRangePickerCalendarCellButtonProps extends ButtonProps {}\n\nexport const CalendarCellButton = withContext(\n    forwardRef<HTMLButtonElement, DateRangePickerCalendarCellButtonProps>(function DateRangePickerCalendarCellButton(props, ref) {\n    return (\n        <Button\n            ref={ref}\n            size=\"sm\"\n            variant=\"ghost\"\n            {...props}\n        />\n    );\n    }),\n    \"calendarCellButton\"\n);\n\nexport interface DateRangePickerRangePresetProps extends BoxProps {}\n\nexport const RangePreset = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerRangePresetProps>(function DateRangePickerRangePreset(props, ref) {\n        const context = useDateRangePickerContext();\n\n        if (!context.presets) {\n            return null;\n        }\n\n        return (\n            <Box\n                ref={ref}\n                {...props}\n            >\n                {Object.values(context.presets).map((preset) => (\n                    <RangePresetButton\n                        key={preset.label}\n                        onClick={() => {\n                            context.setValue(preset.value);\n                            if (preset.value.start) {\n                                context.setViewDate(dayjs(preset.value.start));\n                            }\n                            if (!context.showFooter) {\n                                // Close popover - need to access it from context\n                            }\n                        }}\n                        value={preset.value}\n                    >\n                        {preset.label}\n                    </RangePresetButton>\n                ))}\n            </Box>\n        );\n    }),\n    \"rangePreset\"\n);\n\nexport interface DateRangePickerRangePresetButtonProps extends Omit<ButtonProps, \"value\"> {\n    value: DateRange;\n}\n\nexport const RangePresetButton = withContext(\n    forwardRef<HTMLButtonElement, DateRangePickerRangePresetButtonProps>(function DateRangePickerRangePresetButton(props, ref) {\n        const context = useDateRangePickerContext();\n        const { value: dateRangeValue, ...restProps } = props;\n        const isSelected =\n            context.value?.start &&\n            context.value?.end &&\n            dayjs(context.value.start).isSame(dayjs(dateRangeValue.start), \"day\") &&\n            dayjs(context.value.end).isSame(dayjs(dateRangeValue.end), \"day\");\n\n        const buttonProps: Omit<ButtonProps, \"ref\"> = restProps as Omit<ButtonProps, \"ref\">;\n\n        return (\n            <Button\n                ref={ref}\n                size=\"sm\"\n                variant={isSelected ? \"solid\" : \"outline\"}\n                {...buttonProps}\n            />\n        );\n    }),\n    \"rangePresetButton\"\n);\n\nexport interface DateRangePickerFooterProps extends FlexProps {}\n\nexport const Footer = withContext(\n    forwardRef<HTMLDivElement, DateRangePickerFooterProps>(function DateRangePickerFooter(props, ref) {\n        const context = useDateRangePickerContext();\n\n        if (!context.showFooter) {\n            return null;\n        }\n\n        return (\n            <Flex\n                ref={ref}\n                {...props}\n            >\n                <FooterButton\n                    onClick={context.onCancel}\n                    variant=\"outline\"\n                >\n                    Cancel\n                </FooterButton>\n                <FooterButton\n                    onClick={context.onApply}\n                    variant=\"solid\"\n                >\n                    Apply\n            </FooterButton>\n        </Flex>\n    );\n    }),\n    \"footer\"\n);\n\nexport interface DateRangePickerFooterButtonProps extends ButtonProps {}\n\nexport const FooterButton = withContext(\n    forwardRef<HTMLButtonElement, DateRangePickerFooterButtonProps>(function DateRangePickerFooterButton(props, ref) {\n        return (\n            <Button\n                ref={ref}\n                {...props}\n            />\n        );\n    }),\n    \"footerButton\"\n);\n"
  },
  "component": "DateRangePicker",
  "hasRecipe": true,
  "hasPattern": false,
  "recipeIds": [
    "date-range-picker"
  ]
}