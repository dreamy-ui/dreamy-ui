{
  "type": "component",
  "npmDependencies": [
    "dayjs",
    "react-icons"
  ],
  "fileDependencies": [
    "./box",
    "./button",
    "./flex",
    "./input",
    "./popover"
  ],
  "id": "date-range-picker",
  "file": {
    "name": "date-range-picker.tsx",
    "content": "\"use client\";\r\n\r\nimport { createContext } from \"@dreamy-ui/react\";\r\nimport { useControllableState } from \"@dreamy-ui/react\";\r\nimport dayjs, { type Dayjs } from \"dayjs\";\r\nimport { forwardRef, useMemo, useState } from \"react\";\r\nimport { BiChevronLeft, BiChevronRight } from \"react-icons/bi\";\r\nimport { LuCalendar } from \"react-icons/lu\";\r\nimport { createStyleContext } from \"styled-system/jsx\";\r\nimport { type DateRangePickerVariantProps, dateRangePicker } from \"styled-system/recipes\";\r\nimport { Box, type BoxProps } from \"./box\";\r\nimport { Button, type ButtonProps } from \"./button\";\r\nimport { Flex, type FlexProps } from \"./flex\";\r\nimport { Input as InputComponent, InputGroup, type InputGroupProps, InputRightAddon } from \"./input\";\r\nimport * as Popover from \"./popover\";\r\n\r\nconst { withProvider, withContext } = createStyleContext(dateRangePicker);\r\n\r\nconst WEEKDAYS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\n\r\ninterface DateRange {\r\n    start: Date | null;\r\n    end: Date | null;\r\n}\r\n\r\ninterface DateRangePickerContextValue {\r\n    value: DateRange | null;\r\n    setValue: (range: DateRange | null) => void;\r\n    viewDate: Dayjs;\r\n    setViewDate: (date: Dayjs) => void;\r\n    selectingStart: boolean;\r\n    setSelectingStart: (selecting: boolean) => void;\r\n    minDate?: Date;\r\n    maxDate?: Date;\r\n    dateFormat: string;\r\n    placeholder: string;\r\n    showFooter: boolean;\r\n    presets?: Record<string, { label: string; value: DateRange }>;\r\n    onApply?: () => void;\r\n    onCancel?: () => void;\r\n}\r\n\r\nconst [DateRangePickerProvider, useDateRangePickerContext] =\r\n    createContext<DateRangePickerContextValue>({\r\n        strict: true,\r\n        name: \"DateRangePickerContext\"\r\n    });\r\n\r\nexport interface DateRangePickerRootProps extends Omit<BoxProps, \"defaultValue\" | \"onChange\" | \"value\">, DateRangePickerVariantProps {\r\n    /**\r\n     * The selected date range value\r\n     */\r\n    value?: DateRange | null;\r\n    /**\r\n     * The default selected date range value\r\n     */\r\n    defaultValue?: DateRange | null;\r\n    /**\r\n     * Callback fired when the date range changes\r\n     */\r\n    onChange?: (range: DateRange | null) => void;\r\n    /**\r\n     * The function to call when the apply button is clicked\r\n     */\r\n    onApply?: () => void;\r\n    /**\r\n     * The function to call when the cancel button is clicked\r\n     */\r\n    onCancel?: () => void;\r\n    /**\r\n     * Format string for displaying the date in the input\r\n     * @default \"MMM D, YYYY\"\r\n     */\r\n    dateFormat?: string;\r\n    /**\r\n     * Placeholder text for the input\r\n     * @default \"Select date range\"\r\n     */\r\n    placeholder?: string;\r\n    /**\r\n     * Minimum selectable date\r\n     */\r\n    minDate?: Date;\r\n    /**\r\n     * Maximum selectable date\r\n     */\r\n    maxDate?: Date;\r\n    /**\r\n     * Whether to show the footer with Cancel/Apply buttons\r\n     * @default false\r\n     */\r\n    showFooter?: boolean;\r\n    /**\r\n     * Date range presets to display\r\n     */\r\n    presets?: Record<string, { label: string; value: DateRange }>;\r\n}\r\n\r\nexport const Root = withProvider(\r\n    forwardRef<HTMLDivElement, DateRangePickerRootProps>(function DateRangePickerRoot(props, ref) {\r\n    const {\r\n        value: valueProp,\r\n        defaultValue,\r\n        onChange,\r\n        onApply,\r\n        onCancel,\r\n        dateFormat = \"MMM D, YYYY\",\r\n        placeholder = \"Select date range\",\r\n        minDate,\r\n        maxDate,\r\n        showFooter = false,\r\n        presets,\r\n        children,\r\n        ...rest\r\n    } = props;\r\n\r\n    const [value, setValue] = useControllableState<DateRange | null>({\r\n        value: valueProp,\r\n        defaultValue: defaultValue ?? null,\r\n        onChange\r\n    });\r\n\r\n    const [isOpen, setIsOpen] = useState(false);\r\n    const [viewDate, setViewDate] = useState(() => {\r\n        if (value?.start) return dayjs(value.start);\r\n        return dayjs();\r\n    });\r\n    const [selectingStart, setSelectingStart] = useState(true);\r\n\r\n    const handleApply = () => {\r\n        onApply?.();\r\n        setIsOpen(false);\r\n    };\r\n\r\n    const handleCancel = () => {\r\n        onCancel?.();\r\n        setIsOpen(false);\r\n    };\r\n\r\n    return (\r\n        <DateRangePickerProvider\r\n            value={{\r\n                value,\r\n                setValue: (range) => {\r\n                    setValue(range);\r\n                    if (!showFooter && range?.start && range?.end) {\r\n                        setIsOpen(false);\r\n                    }\r\n                },\r\n                viewDate,\r\n                setViewDate,\r\n                selectingStart,\r\n                setSelectingStart,\r\n                minDate,\r\n                maxDate,\r\n                dateFormat,\r\n                placeholder,\r\n                showFooter,\r\n                presets,\r\n                onApply: handleApply,\r\n                onCancel: handleCancel\r\n            }}\r\n        >\r\n            <Popover.Root\r\n                isOpen={isOpen}\r\n                onOpen={handleApply}\r\n                onClose={handleCancel}\r\n            >\r\n                <Box\r\n                    ref={ref}\r\n                    {...rest}\r\n                >\r\n                    {children}\r\n                </Box>\r\n            </Popover.Root>\r\n        </DateRangePickerProvider>\r\n    );\r\n    }),\r\n    \"root\"\r\n);\r\n\r\nexport interface DateRangePickerTriggerProps extends ButtonProps {}\r\n\r\nexport const Trigger = withContext(\r\n    forwardRef<HTMLButtonElement, DateRangePickerTriggerProps>(function DateRangePickerTrigger(props, ref) {\r\n        return (\r\n            <Popover.Trigger>\r\n                <Button\r\n                    ref={ref}\r\n                    variant=\"outline\"\r\n                    {...props}\r\n                />\r\n            </Popover.Trigger>\r\n        );\r\n    }),\r\n    \"trigger\"\r\n);\r\n\r\nexport interface DateRangePickerInputProps extends InputGroupProps {}\r\n\r\nexport const Input = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerInputProps>(function DateRangePickerInput(props, ref) {\r\n        const context = useDateRangePickerContext();\r\n        const formattedRange =\r\n            context.value?.start && context.value?.end\r\n                ? `${dayjs(context.value.start).format(context.dateFormat)} â€“ ${dayjs(context.value.end).format(context.dateFormat)}`\r\n                : context.placeholder;\r\n\r\n        return (\r\n            <Popover.Trigger>\r\n                <InputGroup ref={ref}>\r\n                    <InputComponent\r\n                        placeholder={context.placeholder}\r\n                        readOnly\r\n                        value={formattedRange}\r\n                        {...props}\r\n                    />\r\n                    <InputRightAddon>\r\n                        <LuCalendar />\r\n                    </InputRightAddon>\r\n                </InputGroup>\r\n            </Popover.Trigger>\r\n        );\r\n    }),\r\n    \"trigger\"\r\n);\r\n\r\nexport interface DateRangePickerPopoverProps extends Omit<Popover.PopoverContentProps, \"transition\"> {}\r\n\r\nexport const PopoverContent = withContext(\r\n    forwardRef<HTMLElement, DateRangePickerPopoverProps>(function DateRangePickerPopover(props, ref) {\r\n        const { transition, ...restProps } = props;\r\n        return (\r\n            <Popover.Content\r\n                ref={ref}\r\n                {...restProps}\r\n            />\r\n        );\r\n    }),\r\n    \"popover\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarProps extends BoxProps {}\r\n\r\nexport const Calendar = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarProps>(function DateRangePickerCalendar(props, ref) {\r\n        const context = useDateRangePickerContext();\r\n        const {\r\n            value,\r\n            setValue,\r\n            viewDate,\r\n            setViewDate,\r\n            selectingStart,\r\n            setSelectingStart,\r\n            minDate,\r\n            maxDate\r\n        } = context;\r\n\r\n        const calendarDays = useMemo(() => {\r\n            const startOfMonth = viewDate.startOf(\"month\");\r\n            const endOfMonth = viewDate.endOf(\"month\");\r\n            const startOfCalendar = startOfMonth.startOf(\"week\");\r\n            const endOfCalendar = endOfMonth.endOf(\"week\");\r\n\r\n            const days: Dayjs[] = [];\r\n            let current = startOfCalendar;\r\n\r\n            while (current.isBefore(endOfCalendar) || current.isSame(endOfCalendar, \"day\")) {\r\n                days.push(current);\r\n                current = current.add(1, \"day\");\r\n            }\r\n\r\n            return days;\r\n        }, [viewDate]);\r\n\r\n        const handlePreviousMonth = () => {\r\n            setViewDate(viewDate.subtract(1, \"month\"));\r\n        };\r\n\r\n        const handleNextMonth = () => {\r\n            setViewDate(viewDate.add(1, \"month\"));\r\n        };\r\n\r\n        const handleDateClick = (date: Dayjs) => {\r\n            if (minDate && date.isBefore(dayjs(minDate), \"day\")) return;\r\n            if (maxDate && date.isAfter(dayjs(maxDate), \"day\")) return;\r\n\r\n            const currentRange = value || { start: null, end: null };\r\n\r\n            if (selectingStart || !currentRange.start) {\r\n                setValue({ start: date.toDate(), end: null });\r\n                setSelectingStart(false);\r\n            } else {\r\n                if (date.isBefore(dayjs(currentRange.start), \"day\")) {\r\n                    setValue({ start: date.toDate(), end: currentRange.start });\r\n                } else {\r\n                    setValue({ start: currentRange.start, end: date.toDate() });\r\n                }\r\n            }\r\n        };\r\n\r\n        const isToday = (date: Dayjs) => date.isSame(dayjs(), \"day\");\r\n        const isStart = (date: Dayjs) => value?.start && dayjs(value.start).isSame(date, \"day\");\r\n        const isEnd = (date: Dayjs) => value?.end && dayjs(value.end).isSame(date, \"day\");\r\n        const isInRange = (date: Dayjs) => {\r\n            if (!value?.start || !value?.end) return false;\r\n            const start = dayjs(value.start);\r\n            const end = dayjs(value.end);\r\n            return date.isAfter(start, \"day\") && date.isBefore(end, \"day\");\r\n        };\r\n        const isOutsideMonth = (date: Dayjs) => !date.isSame(viewDate, \"month\");\r\n        const isDisabled = (date: Dayjs) => {\r\n            if (minDate && date.isBefore(dayjs(minDate), \"day\")) return true;\r\n            if (maxDate && date.isAfter(dayjs(maxDate), \"day\")) return true;\r\n            return false;\r\n        };\r\n\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            >\r\n                <CalendarHeader>\r\n                    <CalendarNav>\r\n                        <CalendarNavButton\r\n                            onClick={handlePreviousMonth}\r\n                            type=\"button\"\r\n                        >\r\n                            <BiChevronLeft />\r\n                        </CalendarNavButton>\r\n                        <CalendarTitle>{viewDate.format(\"MMMM YYYY\")}</CalendarTitle>\r\n                        <CalendarNavButton\r\n                            onClick={handleNextMonth}\r\n                            type=\"button\"\r\n                        >\r\n                            <BiChevronRight />\r\n                        </CalendarNavButton>\r\n                    </CalendarNav>\r\n                </CalendarHeader>\r\n                <CalendarGrid>\r\n                    <CalendarGridHeader>\r\n                        {WEEKDAYS.map((day) => (\r\n                            <CalendarGridHeaderCell key={day}>{day}</CalendarGridHeaderCell>\r\n                        ))}\r\n                    </CalendarGridHeader>\r\n                    <CalendarGridBody>\r\n                        {calendarDays.map((date) => (\r\n                            <CalendarCell key={date.format(\"YYYY-MM-DD\")}>\r\n                                <CalendarCellButton\r\n                                    data-in-range={isInRange(date) ? \"\" : undefined}\r\n                                    data-outside-month={isOutsideMonth(date) ? \"\" : undefined}\r\n                                    data-range-end={isEnd(date) ? \"\" : undefined}\r\n                                    data-range-start={isStart(date) ? \"\" : undefined}\r\n                                    data-selected={isStart(date) || isEnd(date) ? \"\" : undefined}\r\n                                    data-today={isToday(date) ? \"\" : undefined}\r\n                                    disabled={isDisabled(date)}\r\n                                    onClick={() => handleDateClick(date)}\r\n                                    type=\"button\"\r\n                                >\r\n                                    {date.format(\"D\")}\r\n                                </CalendarCellButton>\r\n                            </CalendarCell>\r\n                        ))}\r\n                    </CalendarGridBody>\r\n                </CalendarGrid>\r\n            </Box>\r\n        );\r\n    }),\r\n    \"calendar\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarHeaderProps extends FlexProps {}\r\n\r\nexport const CalendarHeader = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarHeaderProps>(function DateRangePickerCalendarHeader(props, ref) {\r\n        return (\r\n            <Flex\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarHeader\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarTitleProps extends BoxProps {}\r\n\r\nexport const CalendarTitle = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarTitleProps>(function DateRangePickerCalendarTitle(props, ref) {\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarTitle\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarNavProps extends FlexProps {}\r\n\r\nexport const CalendarNav = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarNavProps>(function DateRangePickerCalendarNav(props, ref) {\r\n        return (\r\n            <Flex\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarNav\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarNavButtonProps extends ButtonProps {}\r\n\r\nexport const CalendarNavButton = withContext(\r\n    forwardRef<HTMLButtonElement, DateRangePickerCalendarNavButtonProps>(function DateRangePickerCalendarNavButton(props, ref) {\r\n        return (\r\n            <Button\r\n                ref={ref}\r\n                size=\"sm\"\r\n                variant=\"ghost\"\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarNavButton\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarGridProps extends BoxProps {}\r\n\r\nexport const CalendarGrid = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridProps>(function DateRangePickerCalendarGrid(props, ref) {\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarGrid\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarGridHeaderProps extends BoxProps {}\r\n\r\nexport const CalendarGridHeader = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridHeaderProps>(function DateRangePickerCalendarGridHeader(props, ref) {\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarGridHeader\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarGridHeaderCellProps extends BoxProps {}\r\n\r\nexport const CalendarGridHeaderCell = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridHeaderCellProps>(function DateRangePickerCalendarGridHeaderCell(props, ref) {\r\n    return (\r\n        <Box\r\n            ref={ref}\r\n            {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarGridHeaderCell\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarGridBodyProps extends BoxProps {}\r\n\r\nexport const CalendarGridBody = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarGridBodyProps>(function DateRangePickerCalendarGridBody(props, ref) {\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarGridBody\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarCellProps extends BoxProps {}\r\n\r\nexport const CalendarCell = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerCalendarCellProps>(function DateRangePickerCalendarCell(props, ref) {\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"calendarCell\"\r\n);\r\n\r\nexport interface DateRangePickerCalendarCellButtonProps extends ButtonProps {}\r\n\r\nexport const CalendarCellButton = withContext(\r\n    forwardRef<HTMLButtonElement, DateRangePickerCalendarCellButtonProps>(function DateRangePickerCalendarCellButton(props, ref) {\r\n    return (\r\n        <Button\r\n            ref={ref}\r\n            size=\"sm\"\r\n            variant=\"ghost\"\r\n            {...props}\r\n        />\r\n    );\r\n    }),\r\n    \"calendarCellButton\"\r\n);\r\n\r\nexport interface DateRangePickerRangePresetProps extends BoxProps {}\r\n\r\nexport const RangePreset = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerRangePresetProps>(function DateRangePickerRangePreset(props, ref) {\r\n        const context = useDateRangePickerContext();\r\n\r\n        if (!context.presets) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            >\r\n                {Object.values(context.presets).map((preset) => (\r\n                    <RangePresetButton\r\n                        key={preset.label}\r\n                        onClick={() => {\r\n                            context.setValue(preset.value);\r\n                            if (preset.value.start) {\r\n                                context.setViewDate(dayjs(preset.value.start));\r\n                            }\r\n                            if (!context.showFooter) {\r\n                                // Close popover - need to access it from context\r\n                            }\r\n                        }}\r\n                        value={preset.value}\r\n                    >\r\n                        {preset.label}\r\n                    </RangePresetButton>\r\n                ))}\r\n            </Box>\r\n        );\r\n    }),\r\n    \"rangePreset\"\r\n);\r\n\r\nexport interface DateRangePickerRangePresetButtonProps extends Omit<ButtonProps, \"value\"> {\r\n    value: DateRange;\r\n}\r\n\r\nexport const RangePresetButton = withContext(\r\n    forwardRef<HTMLButtonElement, DateRangePickerRangePresetButtonProps>(function DateRangePickerRangePresetButton(props, ref) {\r\n        const context = useDateRangePickerContext();\r\n        const { value: dateRangeValue, ...restProps } = props;\r\n        const isSelected =\r\n            context.value?.start &&\r\n            context.value?.end &&\r\n            dayjs(context.value.start).isSame(dayjs(dateRangeValue.start), \"day\") &&\r\n            dayjs(context.value.end).isSame(dayjs(dateRangeValue.end), \"day\");\r\n\r\n        const buttonProps: Omit<ButtonProps, \"ref\"> = restProps as Omit<ButtonProps, \"ref\">;\r\n\r\n        return (\r\n            <Button\r\n                ref={ref}\r\n                size=\"sm\"\r\n                variant={isSelected ? \"solid\" : \"outline\"}\r\n                {...buttonProps}\r\n            />\r\n        );\r\n    }),\r\n    \"rangePresetButton\"\r\n);\r\n\r\nexport interface DateRangePickerFooterProps extends FlexProps {}\r\n\r\nexport const Footer = withContext(\r\n    forwardRef<HTMLDivElement, DateRangePickerFooterProps>(function DateRangePickerFooter(props, ref) {\r\n        const context = useDateRangePickerContext();\r\n\r\n        if (!context.showFooter) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <Flex\r\n                ref={ref}\r\n                {...props}\r\n            >\r\n                <FooterButton\r\n                    onClick={context.onCancel}\r\n                    variant=\"outline\"\r\n                >\r\n                    Cancel\r\n                </FooterButton>\r\n                <FooterButton\r\n                    onClick={context.onApply}\r\n                    variant=\"solid\"\r\n                >\r\n                    Apply\r\n            </FooterButton>\r\n        </Flex>\r\n    );\r\n    }),\r\n    \"footer\"\r\n);\r\n\r\nexport interface DateRangePickerFooterButtonProps extends ButtonProps {}\r\n\r\nexport const FooterButton = withContext(\r\n    forwardRef<HTMLButtonElement, DateRangePickerFooterButtonProps>(function DateRangePickerFooterButton(props, ref) {\r\n        return (\r\n            <Button\r\n                ref={ref}\r\n                {...props}\r\n            />\r\n        );\r\n    }),\r\n    \"footerButton\"\r\n);\r\n"
  },
  "component": "DateRangePicker",
  "hasRecipe": true,
  "hasPattern": false,
  "recipeIds": [
    "date-range-picker"
  ]
}