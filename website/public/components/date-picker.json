{
  "type": "component",
  "npmDependencies": [
    "dayjs",
    "react-icons"
  ],
  "fileDependencies": [
    "./box",
    "./button",
    "./flex",
    "./icon",
    "./icon-button",
    "./input",
    "./popover"
  ],
  "id": "date-picker",
  "file": {
    "name": "date-picker.tsx",
    "content": "\"use client\";\r\n\r\nimport { createContext } from \"@dreamy-ui/react\";\r\nimport { useControllableState } from \"@dreamy-ui/react\";\r\nimport dayjs, { type Dayjs } from \"dayjs\";\r\nimport { forwardRef, useMemo, useState } from \"react\";\r\nimport { BiChevronLeft, BiChevronRight } from \"react-icons/bi\";\r\nimport { LuCalendar } from \"react-icons/lu\";\r\nimport { createStyleContext } from \"styled-system/jsx\";\r\nimport { type DatePickerVariantProps, datePicker } from \"styled-system/recipes\";\r\nimport { Box, type BoxProps } from \"./box\";\r\nimport { Button, type ButtonProps } from \"./button\";\r\nimport { Flex, type FlexProps } from \"./flex\";\r\nimport { Icon } from \"./icon\";\r\nimport { IconButton, type IconButtonProps } from \"./icon-button\";\r\nimport {\r\n    Input as InputComponent,\r\n    InputGroup,\r\n    type InputGroupProps,\r\n    InputRightAddon\r\n} from \"./input\";\r\nimport * as Popover from \"./popover\";\r\n\r\nconst { withProvider, withContext } = createStyleContext(datePicker);\r\n\r\nconst WEEKDAYS = [\"Sun\", \"Mon\", \"Tue\", \"Wed\", \"Thu\", \"Fri\", \"Sat\"];\r\n\r\ninterface DatePickerContextValue {\r\n    value: Date | null;\r\n    setValue: (date: Date | null) => void;\r\n    viewDate: Dayjs;\r\n    setViewDate: (date: Dayjs) => void;\r\n    minDate?: Date;\r\n    maxDate?: Date;\r\n    dateFormat: string;\r\n    placeholder: string;\r\n    showFooter: boolean;\r\n    onApply?: () => void;\r\n    onCancel?: () => void;\r\n}\r\n\r\nconst [DatePickerProvider, useDatePickerContext] = createContext<DatePickerContextValue>({\r\n    strict: true,\r\n    name: \"DatePickerContext\"\r\n});\r\n\r\nexport interface DatePickerRootProps\r\n    extends Omit<BoxProps, \"defaultValue\" | \"onChange\" | \"value\">,\r\n        DatePickerVariantProps {\r\n    /**\r\n     * The selected date value\r\n     */\r\n    value?: Date | null;\r\n    /**\r\n     * The default selected date value\r\n     */\r\n    defaultValue?: Date | null;\r\n    /**\r\n     * Callback fired when the date changes\r\n     */\r\n    onChange?: (date: Date | null) => void;\r\n    /**\r\n     * The function to call when the apply button is clicked\r\n     */\r\n    onApply?: () => void;\r\n    /**\r\n     * The function to call when the cancel button is clicked\r\n     */\r\n    onCancel?: () => void;\r\n    /**\r\n     * Format string for displaying the date in the input\r\n     * @default \"MMM D, YYYY\"\r\n     */\r\n    dateFormat?: string;\r\n    /**\r\n     * Placeholder text for the input\r\n     * @default \"Select date\"\r\n     */\r\n    placeholder?: string;\r\n    /**\r\n     * Minimum selectable date\r\n     */\r\n    minDate?: Date;\r\n    /**\r\n     * Maximum selectable date\r\n     */\r\n    maxDate?: Date;\r\n    /**\r\n     * Whether to show the footer with Cancel/Apply buttons\r\n     * @default false\r\n     */\r\n    showFooter?: boolean;\r\n}\r\n\r\nexport const Root = withProvider(\r\n    forwardRef<HTMLDivElement, DatePickerRootProps>(function DatePickerRoot(props, ref) {\r\n        const {\r\n            value: valueProp,\r\n            defaultValue,\r\n            onChange,\r\n            onApply,\r\n            onCancel,\r\n            dateFormat = \"MMM D, YYYY\",\r\n            placeholder = \"Select date\",\r\n            minDate,\r\n            maxDate,\r\n            showFooter = false,\r\n            children,\r\n            ...rest\r\n        } = props;\r\n\r\n        const [value, setValue] = useControllableState({\r\n            value: valueProp,\r\n            defaultValue: defaultValue ?? null,\r\n            onChange\r\n        });\r\n\r\n        const [isOpen, setIsOpen] = useState(false);\r\n        const [viewDate, setViewDate] = useState(() => (value ? dayjs(value) : dayjs()));\r\n\r\n        const handleApply = () => {\r\n            onApply?.();\r\n            setIsOpen(false);\r\n        };\r\n\r\n        const handleCancel = () => {\r\n            onCancel?.();\r\n            setIsOpen(false);\r\n        };\r\n\r\n        return (\r\n            <DatePickerProvider\r\n                value={{\r\n                    value,\r\n                    setValue: (date) => {\r\n                        setValue(date);\r\n                        if (!showFooter && date) {\r\n                            setIsOpen(false);\r\n                        }\r\n                    },\r\n                    viewDate,\r\n                    setViewDate,\r\n                    minDate,\r\n                    maxDate,\r\n                    dateFormat,\r\n                    placeholder,\r\n                    showFooter,\r\n                    onApply: handleApply,\r\n                    onCancel: handleCancel\r\n                }}\r\n            >\r\n                <Popover.Root\r\n                    isOpen={isOpen}\r\n                    onClose={() => setIsOpen(false)}\r\n                    onOpen={() => setIsOpen(true)}\r\n                >\r\n                    <Box\r\n                        ref={ref}\r\n                        {...rest}\r\n                    >\r\n                        {children}\r\n                    </Box>\r\n                </Popover.Root>\r\n            </DatePickerProvider>\r\n        );\r\n    }),\r\n    \"root\"\r\n);\r\n\r\nexport interface DatePickerTriggerProps extends ButtonProps {}\r\n\r\nexport const Trigger = withContext(\r\n    forwardRef<HTMLButtonElement, DatePickerTriggerProps>(function DatePickerTrigger(props, ref) {\r\n        return (\r\n            <Popover.Trigger>\r\n                <Button\r\n                    ref={ref}\r\n                    variant=\"outline\"\r\n                    {...props}\r\n                />\r\n            </Popover.Trigger>\r\n        );\r\n    }),\r\n    \"trigger\"\r\n);\r\n\r\nexport interface DatePickerInputProps extends InputGroupProps {}\r\n\r\nexport const Input = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerInputProps>(function DatePickerInput(props, ref) {\r\n        const context = useDatePickerContext();\r\n        const formattedDate = context.value ? dayjs(context.value).format(context.dateFormat) : \"\";\r\n\r\n        return (\r\n            <Popover.Trigger>\r\n                <InputGroup ref={ref}>\r\n                    <InputComponent\r\n                        placeholder={context.placeholder}\r\n                        readOnly\r\n                        value={formattedDate}\r\n                        {...props}\r\n                    />\r\n                    <InputRightAddon>\r\n                        <LuCalendar />\r\n                    </InputRightAddon>\r\n                </InputGroup>\r\n            </Popover.Trigger>\r\n        );\r\n    }),\r\n    \"trigger\"\r\n);\r\n\r\nexport interface DatePickerPopoverProps extends Popover.PopoverContentProps {}\r\n\r\nexport const PopoverContent = withContext(\r\n    forwardRef<HTMLElement, DatePickerPopoverProps>(function DatePickerPopover(props, ref) {\r\n        const { transition: _, ...restProps } = props;\r\n        return (\r\n            <Popover.Content\r\n                ref={ref}\r\n                {...restProps}\r\n            />\r\n        );\r\n    }),\r\n    \"popover\"\r\n);\r\n\r\nexport interface DatePickerCalendarProps extends BoxProps {}\r\n\r\nexport const Calendar = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarProps>(function DatePickerCalendar(props, ref) {\r\n        const context = useDatePickerContext();\r\n        const { value, setValue, viewDate, setViewDate, minDate, maxDate } = context;\r\n\r\n        const selectedDate = value ? dayjs(value) : null;\r\n\r\n        const calendarDays = useMemo(() => {\r\n            const startOfMonth = viewDate.startOf(\"month\");\r\n            const endOfMonth = viewDate.endOf(\"month\");\r\n            const startOfCalendar = startOfMonth.startOf(\"week\");\r\n            const endOfCalendar = endOfMonth.endOf(\"week\");\r\n\r\n            const days: Dayjs[] = [];\r\n            let current = startOfCalendar;\r\n\r\n            while (current.isBefore(endOfCalendar) || current.isSame(endOfCalendar, \"day\")) {\r\n                days.push(current);\r\n                current = current.add(1, \"day\");\r\n            }\r\n\r\n            return days;\r\n        }, [viewDate]);\r\n\r\n        const handlePreviousMonth = () => {\r\n            setViewDate(viewDate.subtract(1, \"month\"));\r\n        };\r\n\r\n        const handleNextMonth = () => {\r\n            setViewDate(viewDate.add(1, \"month\"));\r\n        };\r\n\r\n        const handleDateClick = (date: Dayjs) => {\r\n            if (minDate && date.isBefore(dayjs(minDate), \"day\")) return;\r\n            if (maxDate && date.isAfter(dayjs(maxDate), \"day\")) return;\r\n            setValue(date.toDate());\r\n        };\r\n\r\n        const isToday = (date: Dayjs) => date.isSame(dayjs(), \"day\");\r\n        const isSelected = (date: Dayjs) => selectedDate?.isSame(date, \"day\");\r\n        const isOutsideMonth = (date: Dayjs) => !date.isSame(viewDate, \"month\");\r\n        const isDisabled = (date: Dayjs) => {\r\n            if (minDate && date.isBefore(dayjs(minDate), \"day\")) return true;\r\n            if (maxDate && date.isAfter(dayjs(maxDate), \"day\")) return true;\r\n            return false;\r\n        };\r\n\r\n        return (\r\n            <Box\r\n                ref={ref}\r\n                {...props}\r\n            >\r\n                <CalendarHeader>\r\n                    <CalendarNav>\r\n                        <CalendarNavButton\r\n                            aria-label=\"Previous month\"\r\n                            onClick={handlePreviousMonth}\r\n                            type=\"button\"\r\n                        >\r\n                            <Icon as={BiChevronLeft} />\r\n                        </CalendarNavButton>\r\n                        <CalendarTitle>{viewDate.format(\"MMMM YYYY\")}</CalendarTitle>\r\n                        <CalendarNavButton\r\n                            aria-label=\"Next month\"\r\n                            onClick={handleNextMonth}\r\n                            type=\"button\"\r\n                        >\r\n                            <Icon as={BiChevronRight} />\r\n                        </CalendarNavButton>\r\n                    </CalendarNav>\r\n                </CalendarHeader>\r\n                <CalendarGrid>\r\n                    <CalendarGridHeader>\r\n                        {WEEKDAYS.map((day) => (\r\n                            <CalendarGridHeaderCell key={day}>{day}</CalendarGridHeaderCell>\r\n                        ))}\r\n                    </CalendarGridHeader>\r\n                    <CalendarGridBody>\r\n                        {calendarDays.map((date) => (\r\n                            <CalendarCell\r\n                                key={`${date.format(\"YYYY-MM-DD\")}-${viewDate.format(\"MM\")}`}\r\n                            >\r\n                                <CalendarCellButton\r\n                                    data-outside-month={isOutsideMonth(date) ? \"\" : undefined}\r\n                                    data-selected={isSelected(date) ? \"\" : undefined}\r\n                                    data-today={isToday(date) ? \"\" : undefined}\r\n                                    disabled={isDisabled(date)}\r\n                                    onClick={() => handleDateClick(date)}\r\n                                    type=\"button\"\r\n                                >\r\n                                    {date.format(\"D\")}\r\n                                </CalendarCellButton>\r\n                            </CalendarCell>\r\n                        ))}\r\n                    </CalendarGridBody>\r\n                </CalendarGrid>\r\n            </Box>\r\n        );\r\n    }),\r\n    \"calendar\"\r\n);\r\n\r\nexport interface DatePickerCalendarHeaderProps extends FlexProps {}\r\n\r\nexport const CalendarHeader = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarHeaderProps>(\r\n        function DatePickerCalendarHeader(props, ref) {\r\n            return (\r\n                <Flex\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarHeader\"\r\n);\r\n\r\nexport interface DatePickerCalendarTitleProps extends BoxProps {}\r\n\r\nexport const CalendarTitle = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarTitleProps>(\r\n        function DatePickerCalendarTitle(props, ref) {\r\n            return (\r\n                <Box\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarTitle\"\r\n);\r\n\r\nexport interface DatePickerCalendarNavProps extends FlexProps {}\r\n\r\nexport const CalendarNav = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarNavProps>(\r\n        function DatePickerCalendarNav(props, ref) {\r\n            return (\r\n                <Flex\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarNav\"\r\n);\r\n\r\nexport interface DatePickerCalendarNavButtonProps extends IconButtonProps {}\r\n\r\nexport const CalendarNavButton = withContext(\r\n    forwardRef<HTMLButtonElement, DatePickerCalendarNavButtonProps>(\r\n        function DatePickerCalendarNavButton(props, ref) {\r\n            return (\r\n                <IconButton\r\n                    ref={ref}\r\n                    size=\"sm\"\r\n                    variant=\"ghost\"\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarNavButton\"\r\n);\r\n\r\nexport interface DatePickerCalendarGridProps extends BoxProps {}\r\n\r\nexport const CalendarGrid = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarGridProps>(\r\n        function DatePickerCalendarGrid(props, ref) {\r\n            return (\r\n                <Box\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarGrid\"\r\n);\r\n\r\nexport interface DatePickerCalendarGridHeaderProps extends BoxProps {}\r\n\r\nexport const CalendarGridHeader = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarGridHeaderProps>(\r\n        function DatePickerCalendarGridHeader(props, ref) {\r\n            return (\r\n                <Box\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarGridHeader\"\r\n);\r\n\r\nexport interface DatePickerCalendarGridHeaderCellProps extends BoxProps {}\r\n\r\nexport const CalendarGridHeaderCell = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarGridHeaderCellProps>(\r\n        function DatePickerCalendarGridHeaderCell(props, ref) {\r\n            return (\r\n                <Box\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarGridHeaderCell\"\r\n);\r\n\r\nexport interface DatePickerCalendarGridBodyProps extends BoxProps {}\r\n\r\nexport const CalendarGridBody = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarGridBodyProps>(\r\n        function DatePickerCalendarGridBody(props, ref) {\r\n            return (\r\n                <Box\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarGridBody\"\r\n);\r\n\r\nexport interface DatePickerCalendarCellProps extends BoxProps {}\r\n\r\nexport const CalendarCell = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerCalendarCellProps>(\r\n        function DatePickerCalendarCell(props, ref) {\r\n            return (\r\n                <Box\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarCell\"\r\n);\r\n\r\nexport interface DatePickerCalendarCellButtonProps extends ButtonProps {}\r\n\r\nexport const CalendarCellButton = withContext(\r\n    forwardRef<HTMLButtonElement, DatePickerCalendarCellButtonProps>(\r\n        function DatePickerCalendarCellButton(props, ref) {\r\n            return (\r\n                <Button\r\n                    ref={ref}\r\n                    size=\"md\"\r\n                    variant=\"ghost\"\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"calendarCellButton\"\r\n);\r\n\r\nexport interface DatePickerFooterProps extends FlexProps {}\r\n\r\nexport const Footer = withContext(\r\n    forwardRef<HTMLDivElement, DatePickerFooterProps>(function DatePickerFooter(props, ref) {\r\n        const context = useDatePickerContext();\r\n\r\n        if (!context.showFooter) {\r\n            return null;\r\n        }\r\n\r\n        return (\r\n            <Flex\r\n                ref={ref}\r\n                {...props}\r\n            >\r\n                <FooterButton\r\n                    onClick={context.onCancel}\r\n                    variant=\"outline\"\r\n                >\r\n                    Cancel\r\n                </FooterButton>\r\n                <FooterButton\r\n                    onClick={context.onApply}\r\n                    variant=\"solid\"\r\n                >\r\n                    Apply\r\n                </FooterButton>\r\n            </Flex>\r\n        );\r\n    }),\r\n    \"footer\"\r\n);\r\n\r\nexport interface DatePickerFooterButtonProps extends ButtonProps {}\r\n\r\nexport const FooterButton = withContext(\r\n    forwardRef<HTMLButtonElement, DatePickerFooterButtonProps>(\r\n        function DatePickerFooterButton(props, ref) {\r\n            return (\r\n                <Button\r\n                    ref={ref}\r\n                    {...props}\r\n                />\r\n            );\r\n        }\r\n    ),\r\n    \"footerButton\"\r\n);\r\n"
  },
  "component": "DatePicker",
  "hasRecipe": true,
  "hasPattern": false,
  "recipeIds": [
    "date-picker"
  ]
}